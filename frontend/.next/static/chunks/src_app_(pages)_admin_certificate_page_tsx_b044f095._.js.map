{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Admin/massage-spa-training-system/frontend/src/app/%28pages%29/admin/certificate/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\n\r\nimport '@ant-design/v5-patch-for-react-19';\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { Tabs, Table, Button, Space, Modal, Input, message, Tag, Typography, Breadcrumb, Card } from 'antd';\r\nimport { EditOutlined, EyeOutlined, PlusOutlined, SearchOutlined, DeleteOutlined, HomeOutlined, TrophyOutlined, PrinterOutlined } from '@ant-design/icons';\r\nimport type { TabsProps } from 'antd';\r\nimport dayjs from 'dayjs';\r\nimport 'dayjs/locale/th'; // Import Thai locale for dayjs\r\nimport { v4 as uuidv4 } from 'uuid'; // For generating unique IDs\r\nimport dynamic from 'next/dynamic'; // Import dynamic for client-side rendering\r\nimport type Konva from 'konva'; // Import Konva as a type only to avoid SSR issues\r\n\r\ndayjs.locale('th');\r\n\r\nconst { Text, Title: AntdTitle } = Typography;\r\n\r\n// Dynamically import CertificateCanvas to ensure it's client-side rendered\r\n// This is crucial for Konva to work in the browser environment\r\nconst DynamicCertificateCanvas = dynamic(\r\n  () => import('./manage/certificateCanvas'), // Path to the canvas component\r\n  { ssr: false }\r\n);\r\n\r\n// Base dimensions for the certificate design (A4 landscape ratio) - must match CertificateCanvas\r\nconst DESIGN_WIDTH = 720;\r\nconst DESIGN_HEIGHT = 508.5;\r\n\r\n// --- Interfaces for Certificate Templates ---\r\ninterface DesignElements {\r\n  backgroundColor: string;\r\n  textColor: string;\r\n  fontFamily: string;\r\n  fontSize: number; // Base font size\r\n  titleText: string;\r\n  studentNamePlaceholder: string;\r\n  courseNamePlaceholder: string;\r\n  issueDatePlaceholder: string;\r\n  signatureText: string;\r\n  signatureLine2: string;\r\n  logoUrl?: string;\r\n\r\n  titlePosX: number;\r\n  titlePosY: number;\r\n  studentNamePosX: number;\r\n  studentNamePosY: number;\r\n  courseNamePosX: number;\r\n  courseNamePosY: number;\r\n  issueDateTextPosX: number;\r\n  issueDateTextPosY: number;\r\n  issueDateValuePosX: number;\r\n  issueDateValuePosY: number;\r\n  signatureBlockPosX: number;\r\n  signatureBlockPosY: number;\r\n\r\n  mainBorderWidth: number;\r\n  mainBorderColor: string;\r\n  mainBorderRadius: number;\r\n  mainBorderStyle: 'solid' | 'dashed';\r\n  mainBorderDashLength: number;\r\n  mainBorderDashGap: number;\r\n  innerBorder1Width: number;\r\n  innerBorder1Color: string;\r\n  innerBorder1DashLength: number;\r\n  innerBorder1DashGap: number;\r\n  innerBorder2Width: number;\r\n  innerBorder2Color: string;\r\n}\r\n\r\ninterface CertificateTemplate {\r\n  id: string;\r\n  templateName: string;\r\n  description: string;\r\n  status: 'Draft' | 'Published';\r\n  createdAt: string;\r\n  updatedAt: string;\r\n  designElements: DesignElements;\r\n}\r\n\r\n// Default design elements for a Thai formal certificate template (copied from manage/page.tsx)\r\n// This is crucial for ensuring all design properties are present when viewing older templates\r\nconst defaultDesignElements: DesignElements = {\r\n  backgroundColor: '#F8F8F8', // Light grey/off-white\r\n  textColor: '#333333',     // Dark grey\r\n  fontFamily: 'Prompt',     // Default font\r\n  fontSize: 24,\r\n  titleText: 'ประกาศนียบัตร',\r\n  studentNamePlaceholder: 'นาย/นาง/นางสาว [ชื่อ-นามสกุล]',\r\n  courseNamePlaceholder: 'หลักสูตร [ชื่อหลักสูตร]',\r\n  issueDatePlaceholder: 'วันที่ [วันที่ออกเกียรติบัตร]',\r\n  signatureText: 'ชื่อผู้บริหาร',\r\n  signatureLine2: 'โรงเรียนนวดแผนไทย',\r\n  logoUrl: 'https://placehold.co/100x50/cccccc/ffffff?text=Logo',\r\n\r\n  // Default positions (relative to DESIGN_WIDTH/HEIGHT) - adjusted for a more formal Thai layout\r\n  titlePosX: DESIGN_WIDTH / 2, // Centered\r\n  titlePosY: DESIGN_HEIGHT * 0.15,\r\n  studentNamePosX: DESIGN_WIDTH / 2, // Centered\r\n  studentNamePosY: DESIGN_HEIGHT * 0.45,\r\n  courseNamePosX: DESIGN_WIDTH / 2, // Centered\r\n  courseNamePosY: DESIGN_HEIGHT * 0.65,\r\n  issueDateTextPosX: DESIGN_WIDTH * 0.36, // Adjusted to be closer to left edge\r\n  issueDateTextPosY: DESIGN_HEIGHT * 0.75,\r\n  issueDateValuePosX: DESIGN_WIDTH * 0.44, // Adjusted to be aligned with issueDateText\r\n  issueDateValuePosY: DESIGN_HEIGHT * 0.75,\r\n  signatureBlockPosX: DESIGN_WIDTH * 0.65, // Adjusted to be further from right edge\r\n  signatureBlockPosY: DESIGN_HEIGHT - 80,\r\n\r\n  // Default border properties for a formal Thai look\r\n  mainBorderWidth: 5,\r\n  mainBorderColor: '#A52A2A', // Brown\r\n  mainBorderRadius: 10,\r\n  mainBorderStyle: 'solid',\r\n  mainBorderDashLength: 0,\r\n  mainBorderDashGap: 0,\r\n  innerBorder1Width: 2,\r\n  innerBorder1Color: '#8B4513', // Saddlebrown\r\n  innerBorder1DashLength: 10,\r\n  innerBorder1DashGap: 5,\r\n  innerBorder2Width: 1,\r\n  innerBorder2Color: '#CD853F', // Peru\r\n};\r\n\r\n\r\n// --- Interfaces for Issued Certificates ---\r\ninterface IssuedCertificate {\r\n  id: string;\r\n  templateName: string;\r\n  studentName: string;\r\n  courseTitle: string;\r\n  issueDate: string; // YYYY-MM-DD\r\n  status: 'Issued' | 'Revoked';\r\n}\r\n\r\nexport default function CertificatePage() {\r\n  const [activeTab, setActiveTab] = useState('templates'); // Default to templates tab\r\n\r\n  // --- State for Certificate Templates Tab ---\r\n  const [certificateTemplates, setCertificateTemplates] = useState<CertificateTemplate[]>([]);\r\n  const [searchTermTemplates, setSearchTermTemplates] = useState('');\r\n  const [isTemplateDetailModalVisible, setIsTemplateDetailModalVisible] = useState(false);\r\n  const [viewingTemplate, setViewingTemplate] = useState<CertificateTemplate | null>(null);\r\n  const [hasLoadedTemplates, setHasLoadedTemplates] = useState(false); // New state for hydration\r\n\r\n  // Ref for the Konva Stage in the preview modal\r\n  const stageRefForPreview = useRef<Konva.Stage | null>(null);\r\n\r\n  // --- State for Issued Certificates Tab ---\r\n  const [issuedCertificates, setIssuedCertificates] = useState<IssuedCertificate[]>([\r\n    {\r\n      id: uuidv4(),\r\n      templateName: 'ใบประกาศนวดแผนไทย',\r\n      studentName: 'สมชาย ใจดี',\r\n      courseTitle: 'หลักสูตรนวดแผนไทยเบื้องต้น',\r\n      issueDate: '2023-07-15',\r\n      status: 'Issued',\r\n    },\r\n    {\r\n      id: uuidv4(),\r\n      templateName: 'ประกาศนียบัตรสปา',\r\n      studentName: 'สมหญิง รักเรียน',\r\n      courseTitle: 'หลักสูตรสปาเพื่อสุขภาพ',\r\n      issueDate: '2023-07-20',\r\n      status: 'Issued',\r\n    },\r\n    {\r\n      id: uuidv4(),\r\n      templateName: 'ใบรับรองอโรมาเธอราพี',\r\n      studentName: 'มานะ พากเพียร',\r\n      courseTitle: 'หลักสูตรอโรมาเธอราพี',\r\n      issueDate: '2023-07-25',\r\n      status: 'Revoked',\r\n    },\r\n  ]);\r\n  const [searchTermIssued, setSearchTermIssued] = useState('');\r\n  const [isIssuedDetailModalVisible, setIsIssuedDetailModalVisible] = useState(false);\r\n  const [viewingIssued, setViewingIssued] = useState<IssuedCertificate | null>(null);\r\n  const [hasLoadedIssued, setHasLoadedIssued] = useState(false); // New state for hydration for issued\r\n\r\n  // Load certificate templates from localStorage on component mount (client-side only)\r\n  useEffect(() => {\r\n    const loadTemplates = () => {\r\n      try {\r\n        const storedTemplates = JSON.parse(localStorage.getItem('certificateTemplates') || '[]') as CertificateTemplate[];\r\n        setCertificateTemplates(storedTemplates);\r\n        setHasLoadedTemplates(true); // Mark templates as loaded\r\n      } catch (error) {\r\n        console.error(\"Failed to parse certificateTemplates from localStorage\", error);\r\n        setCertificateTemplates([]);\r\n        setHasLoadedTemplates(true); // Still mark as loaded to proceed\r\n      }\r\n    };\r\n    loadTemplates();\r\n\r\n    // Add event listener for 'storage' to update when localStorage changes from other tabs\r\n    const handleStorageChange = (event: StorageEvent) => {\r\n      if (event.key === 'certificateTemplates') {\r\n        loadTemplates();\r\n      }\r\n    };\r\n    window.addEventListener('storage', handleStorageChange);\r\n\r\n    return () => {\r\n      window.removeEventListener('storage', handleStorageChange);\r\n    };\r\n  }, []);\r\n\r\n  // --- Certificate Templates Handlers ---\r\n  const handleCreateTemplate = () => {\r\n    window.location.href = '/admin/certificate/manage';\r\n  };\r\n\r\n  const handleEditTemplate = (templateId: string) => {\r\n    window.location.href = `/admin/certificate/manage?id=${templateId}`;\r\n  };\r\n\r\n  const handleDeleteTemplate = (templateId: string) => {\r\n    Modal.confirm({\r\n      title: 'ยืนยันการลบ',\r\n      content: 'คุณแน่ใจหรือไม่ว่าต้องการลบแม่แบบเกียรติบัตรนี้? การดำเนินการนี้ไม่สามารถย้อนกลับได้',\r\n      okText: 'ลบ',\r\n      cancelText: 'ยกเลิก',\r\n      onOk() {\r\n        setCertificateTemplates(prevTemplates => {\r\n          const updatedTemplates = prevTemplates.filter(template => template.id !== templateId);\r\n          localStorage.setItem('certificateTemplates', JSON.stringify(updatedTemplates));\r\n          message.success('ลบแม่แบบเกียรติบัตรเรียบร้อยแล้ว!');\r\n          return updatedTemplates;\r\n        });\r\n      },\r\n    });\r\n  };\r\n\r\n  const handleViewTemplate = (record: CertificateTemplate) => {\r\n    // Ensure designElements has all default properties if some are missing from old data\r\n    const mergedDesignElements = { ...defaultDesignElements, ...record.designElements };\r\n    setViewingTemplate({ ...record, designElements: mergedDesignElements });\r\n    setIsTemplateDetailModalVisible(true);\r\n  };\r\n\r\n  const handleTemplateDetailModalCancel = () => {\r\n    setIsTemplateDetailModalVisible(false);\r\n    setViewingTemplate(null);\r\n  };\r\n\r\n  // Helper function to draw elements onto a Konva Layer\r\n  // This function is crucial for creating the high-resolution image for printing\r\n  const drawCertificateElements = async (layer: Konva.Layer, design: DesignElements, width: number, height: number, KonvaRef: typeof Konva) => {\r\n    // Background\r\n    layer.add(new KonvaRef.Rect({\r\n      x: 0, y: 0,\r\n      width: width, height: height,\r\n      fill: design.backgroundColor,\r\n    }));\r\n\r\n    // Main Border\r\n    layer.add(new KonvaRef.Rect({\r\n      x: 0,\r\n      y: 0,\r\n      width: width,\r\n      height: height,\r\n      stroke: design.mainBorderColor,\r\n      strokeWidth: design.mainBorderWidth,\r\n      cornerRadius: design.mainBorderRadius,\r\n      dash: design.mainBorderStyle === 'dashed' ? [design.mainBorderDashLength, design.mainBorderDashGap] : [],\r\n    }));\r\n\r\n    // Inner Border 1\r\n    layer.add(new KonvaRef.Rect({\r\n      x: design.mainBorderWidth + design.innerBorder1Width / 2,\r\n      y: design.mainBorderWidth + design.innerBorder1Width / 2,\r\n      width: width - design.mainBorderWidth * 2 - design.innerBorder1Width,\r\n      height: height - design.mainBorderWidth * 2 - design.innerBorder1Width,\r\n      stroke: design.innerBorder1Color,\r\n      strokeWidth: design.innerBorder1Width,\r\n      dash: [design.innerBorder1DashLength, design.innerBorder1DashGap],\r\n    }));\r\n\r\n    // Inner Border 2\r\n    layer.add(new KonvaRef.Rect({\r\n      x: design.mainBorderWidth + design.innerBorder1Width + design.innerBorder2Width / 2,\r\n      y: design.mainBorderWidth + design.innerBorder1Width + design.innerBorder2Width / 2,\r\n      width: width - design.mainBorderWidth * 2 - design.innerBorder1Width * 2 - design.innerBorder2Width,\r\n      height: height - design.mainBorderWidth * 2 - design.innerBorder1Width * 2 - design.innerBorder2Width,\r\n      stroke: design.innerBorder2Color,\r\n      strokeWidth: design.innerBorder2Width,\r\n    }));\r\n\r\n    // Title Text\r\n    layer.add(new KonvaRef.Text({\r\n      text: design.titleText,\r\n      x: 0, // Set x to 0 for center alignment\r\n      y: design.titlePosY,\r\n      fontSize: design.fontSize + 10,\r\n      fontFamily: design.fontFamily,\r\n      fill: design.textColor,\r\n      align: \"center\",\r\n      width: width, // Use full width for centering\r\n    }));\r\n    // \"มอบให้แก่\" - Fixed text, centered\r\n    layer.add(new KonvaRef.Text({\r\n      text: \"มอบให้แก่\",\r\n      x: 0, // Set x to 0 for center alignment\r\n      y: DESIGN_HEIGHT * 0.30,\r\n      fontSize: design.fontSize,\r\n      fontFamily: design.fontFamily,\r\n      fill: design.textColor,\r\n      align: \"center\",\r\n      width: width,\r\n    }));\r\n    // Student Name\r\n    layer.add(new KonvaRef.Text({\r\n      text: design.studentNamePlaceholder,\r\n      x: 0, // Set x to 0 for center alignment\r\n      y: design.studentNamePosY,\r\n      fontSize: design.fontSize + 6,\r\n      fontFamily: design.fontFamily,\r\n      fill: design.textColor,\r\n      align: \"center\",\r\n      width: width,\r\n    }));\r\n    // \"เพื่อแสดงว่าได้สำเร็จหลักสูตร\" - Fixed text, centered\r\n    layer.add(new KonvaRef.Text({\r\n      text: \"เพื่อแสดงว่าได้สำเร็จหลักสูตร\",\r\n      x: 0, // Set x to 0 for center alignment\r\n      y: DESIGN_HEIGHT * 0.55,\r\n      fontSize: design.fontSize,\r\n      fontFamily: design.fontFamily,\r\n      fill: design.textColor,\r\n      align: \"center\",\r\n      width: width,\r\n    }));\r\n    // Course Name\r\n    layer.add(new KonvaRef.Text({\r\n      text: design.courseNamePlaceholder,\r\n      x: 0, // Set x to 0 for center alignment\r\n      y: design.courseNamePosY,\r\n      fontSize: design.fontSize + 6,\r\n      fontFamily: design.fontFamily,\r\n      fill: design.textColor,\r\n      align: \"center\",\r\n      width: width,\r\n    }));\r\n    // \"ณ วันที่\" - Text, left-aligned relative to its X\r\n    layer.add(new KonvaRef.Text({\r\n      text: \"ณ วันที่\",\r\n      x: design.issueDateTextPosX,\r\n      y: design.issueDateTextPosY,\r\n      fontSize: design.fontSize - 8,\r\n      fontFamily: design.fontFamily,\r\n      fill: design.textColor,\r\n      align: 'left'\r\n    }));\r\n    // Issue Date Value - Text, left-aligned relative to its X\r\n    layer.add(new KonvaRef.Text({\r\n      text: design.issueDatePlaceholder || dayjs().format('DD MMMM YYYY'),\r\n      x: design.issueDateValuePosX,\r\n      y: design.issueDateValuePosY,\r\n      fontSize: design.fontSize - 8,\r\n      fontFamily: design.fontFamily,\r\n      fill: design.textColor,\r\n      align: 'left'\r\n    }));\r\n    // Signature Lines - Text block, right-aligned relative to its X\r\n    layer.add(new KonvaRef.Text({\r\n      text: `(_________________________)\\n\\n${design.signatureText}\\n${design.signatureLine2}`,\r\n      x: design.signatureBlockPosX,\r\n      y: design.signatureBlockPosY,\r\n      fontSize: design.fontSize - 12,\r\n      fontFamily: design.fontFamily,\r\n      fill: design.textColor,\r\n      align: 'right',\r\n      width: 200, // Fixed width for signature block\r\n    }));\r\n\r\n    // Handle logo asynchronously\r\n    if (design.logoUrl) {\r\n      const img = new window.Image();\r\n      img.src = design.logoUrl;\r\n      img.crossOrigin = 'Anonymous'; // Important for CORS if image is external\r\n      await new Promise<void>((resolve) => {\r\n        img.onload = () => {\r\n          layer.add(new KonvaRef.Image({\r\n            image: img,\r\n            x: 20, // Example position\r\n            y: 20, // Example position\r\n            width: 100, // Example size\r\n            height: 50, // Example size\r\n          }));\r\n          layer.batchDraw(); // Redraw after image loads\r\n          resolve();\r\n        };\r\n        img.onerror = () => {\r\n          console.error(\"Failed to load logo image for printing:\", design.logoUrl);\r\n          resolve(); // Resolve even on error to not block the promise\r\n        };\r\n      });\r\n    }\r\n  };\r\n\r\n\r\n  const handlePrintCertificate = async () => {\r\n    // Crucial check to ensure this code only runs on the client-side\r\n    if (typeof window === 'undefined') {\r\n      console.warn(\"Attempted to print certificate on server, skipping.\");\r\n      return;\r\n    }\r\n\r\n    if (!viewingTemplate || !viewingTemplate.designElements) {\r\n      message.error('ไม่พบข้อมูลแม่แบบสำหรับพิมพ์');\r\n      return;\r\n    }\r\n\r\n    const design = viewingTemplate.designElements;\r\n\r\n    // Dynamically import Konva here to ensure it's only loaded client-side when needed\r\n    const KonvaModule = await import('konva');\r\n    const KonvaRef: typeof Konva = KonvaModule.default; // Get the default export and type it\r\n\r\n    // Create a temporary Konva Stage in memory\r\n    const tempStage = new KonvaRef.Stage({\r\n      container: document.createElement('div'), // Needs a dummy container\r\n      width: DESIGN_WIDTH,\r\n      height: DESIGN_HEIGHT,\r\n    });\r\n\r\n    const tempLayer = new KonvaRef.Layer();\r\n    tempStage.add(tempLayer);\r\n\r\n    // Draw all elements onto the temporary layer, awaiting for async elements like images\r\n    await drawCertificateElements(tempLayer, design, DESIGN_WIDTH, DESIGN_HEIGHT, KonvaRef);\r\n\r\n    // Use a Promise to ensure all elements (especially async images) are drawn before converting to DataURL\r\n    const renderPromise = new Promise<string>((resolve) => {\r\n      // Small delay to allow Konva to render, especially for async image loading\r\n      // This delay might need adjustment based on image loading times\r\n      setTimeout(() => {\r\n        const dataURL = tempStage.toDataURL({\r\n          mimeType: 'image/jpeg',\r\n          quality: 1,\r\n          pixelRatio: 2, // High pixel ratio for print quality\r\n        });\r\n        tempStage.destroy(); // Destroy the temporary stage to free memory\r\n        resolve(dataURL);\r\n      }, 500); // Increased delay slightly to ensure image loads\r\n    });\r\n\r\n    renderPromise.then(dataURL => {\r\n      const printWindow = window.open('', '_blank');\r\n      if (printWindow) {\r\n        printWindow.document.write(`\r\n          <html>\r\n          <head>\r\n              <title>พิมพ์เกียรติบัตร - ${viewingTemplate.templateName}</title>\r\n              <style>\r\n                  /* CSS for A4 landscape printing */\r\n                  @page {\r\n                      size: A4 landscape;\r\n                      margin: 0;\r\n                  }\r\n                  body {\r\n                      margin: 0;\r\n                      display: flex;\r\n                      justify-content: center;\r\n                      align-items: center;\r\n                      min-height: 100vh; /* Ensure it takes full viewport height */\r\n                      background-color: #f0f0f0; /* Light background for visual separation */\r\n                  }\r\n                  img {\r\n                      max-width: 100vw;\r\n                      max-height: 100vh;\r\n                      display: block;\r\n                      margin: auto;\r\n                      box-shadow: 0 0 10px rgba(0,0,0,0.1); /* Optional: for screen preview */\r\n                  }\r\n                  /* Print-specific styles */\r\n                  @media print {\r\n                      body {\r\n                          background-color: white;\r\n                      }\r\n                      img {\r\n                          width: 100%; /* Ensure image fills the printable area */\r\n                          height: auto;\r\n                          max-width: unset;\r\n                          max-height: unset;\r\n                          box-shadow: none;\r\n                      }\r\n                  }\r\n              </style>\r\n          </head>\r\n          <body>\r\n              <img src=\"${dataURL}\" alt=\"Certificate for Print\" />\r\n              <script>\r\n                  window.onload = function() {\r\n                      window.print();\r\n                      // Optional: Close window after printing, but sometimes users want to save as PDF\r\n                      // window.onafterprint = function() { window.close(); };\r\n                  };\r\n              </script>\r\n          </body>\r\n          </html>\r\n        `);\r\n        printWindow.document.close();\r\n      } else {\r\n        message.error('ไม่สามารถเปิดหน้าต่างพิมพ์ได้ กรุณาอนุญาต Pop-ups');\r\n      }\r\n    }).catch(error => {\r\n      console.error(\"Error generating certificate for print:\", error);\r\n      message.error('เกิดข้อผิดพลาดในการเตรียมเกียรติบัตรสำหรับพิมพ์');\r\n    });\r\n  };\r\n\r\n\r\n  // --- Issued Certificates Handlers ---\r\n  useEffect(() => {\r\n    setHasLoadedIssued(true);\r\n  }, []);\r\n\r\n  const handleViewIssued = (record: IssuedCertificate) => {\r\n    setViewingIssued(record);\r\n    setIsIssuedDetailModalVisible(true);\r\n  };\r\n\r\n  const handleIssuedDetailModalCancel = () => {\r\n    setIsIssuedDetailModalVisible(false);\r\n    setViewingIssued(null);\r\n  };\r\n\r\n  const handleDeleteIssued = (issuedId: string) => {\r\n    Modal.confirm({\r\n      title: 'ยืนยันการลบ',\r\n      content: 'คุณแน่ใจหรือไม่ว่าต้องการลบข้อมูลเกียรติบัตรที่ออกแล้วนี้? การดำเนินการนี้ไม่สามารถย้อนกลับได้',\r\n      okText: 'ลบ',\r\n      cancelText: 'ยกเลิก',\r\n      onOk() {\r\n        setIssuedCertificates(prevIssued => {\r\n          const updatedIssued = prevIssued.filter(issued => issued.id !== issuedId);\r\n          message.success('ลบข้อมูลเกียรติบัตรที่ออกแล้วเรียบร้อยแล้ว!');\r\n          return updatedIssued;\r\n        });\r\n      },\r\n    });\r\n  };\r\n\r\n  // --- Filtered Data ---\r\n  const filteredTemplates = certificateTemplates.filter(template =>\r\n    template.templateName.toLowerCase().includes(searchTermTemplates.toLowerCase()) ||\r\n    template.description.toLowerCase().includes(searchTermTemplates.toLowerCase()) ||\r\n    template.status.toLowerCase().includes(searchTermTemplates.toLowerCase())\r\n  );\r\n\r\n  const filteredIssued = issuedCertificates.filter(issued =>\r\n    issued.templateName.toLowerCase().includes(searchTermIssued.toLowerCase()) ||\r\n    issued.studentName.toLowerCase().includes(searchTermIssued.toLowerCase()) ||\r\n    issued.courseTitle.toLowerCase().includes(searchTermIssued.toLowerCase()) ||\r\n    issued.issueDate.includes(searchTermIssued) ||\r\n    issued.status.toLowerCase().includes(searchTermIssued.toLowerCase())\r\n  );\r\n\r\n  // --- Columns for Certificate Templates Tab ---\r\n  const templateColumns = [\r\n    {\r\n      title: '#',\r\n      render: (_: unknown, __: unknown, index: number) => index + 1,\r\n      width: 50,\r\n      className: 'text-gray-600',\r\n    },\r\n    {\r\n      title: 'TEMPLATE NAME',\r\n      dataIndex: 'templateName',\r\n      key: 'templateName',\r\n      className: 'font-medium text-gray-900',\r\n    },\r\n    {\r\n      title: 'DESCRIPTION',\r\n      dataIndex: 'description',\r\n      key: 'description',\r\n      ellipsis: true,\r\n      className: 'text-gray-700',\r\n    },\r\n    {\r\n      title: 'STATUS',\r\n      dataIndex: 'status',\r\n      key: 'status',\r\n      render: (status: 'Draft' | 'Published') => (\r\n        <Tag color={status === 'Published' ? 'green' : 'blue'} className=\"rounded-full px-3 py-1 text-xs font-semibold\">\r\n          {status}\r\n        </Tag>\r\n      ),\r\n      className: 'text-center',\r\n    },\r\n    {\r\n      title: 'CREATED AT',\r\n      dataIndex: 'createdAt',\r\n      key: 'createdAt',\r\n      render: (date: string) => dayjs(date).format('DD/MM/YYYY, HH:mm'),\r\n      className: 'text-gray-700',\r\n    },\r\n    {\r\n      title: 'UPDATED AT',\r\n      dataIndex: 'updatedAt',\r\n      key: 'updatedAt',\r\n      render: (date: string) => dayjs(date).format('DD/MM/YYYY, HH:mm'),\r\n      className: 'text-gray-700',\r\n    },\r\n    {\r\n      title: 'ACTIONS',\r\n      key: 'actions',\r\n      render: (_: unknown, record: CertificateTemplate) => (\r\n        <Space size=\"middle\">\r\n          <Button\r\n            icon={<EyeOutlined />}\r\n            onClick={() => handleViewTemplate(record)}\r\n            className=\"text-gray-500 border-none shadow-none hover:bg-gray-50\"\r\n          />\r\n          <Button icon={<EditOutlined />} onClick={() => handleEditTemplate(record.id)} className=\"text-blue-500 border-none shadow-none hover:bg-blue-50\" />\r\n          <Button\r\n            icon={<DeleteOutlined />}\r\n            danger\r\n            onClick={() => handleDeleteTemplate(record.id)}\r\n            className=\"text-red-500 border-none shadow-none hover:bg-red-50\"\r\n          />\r\n        </Space>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  // --- Columns for Issued Certificates Tab ---\r\n  const issuedColumns = [\r\n    {\r\n      title: '#',\r\n      render: (_: unknown, __: unknown, index: number) => index + 1,\r\n      width: 50,\r\n      className: 'text-gray-600',\r\n    },\r\n    {\r\n      title: 'TEMPLATE',\r\n      dataIndex: 'templateName',\r\n      key: 'templateName',\r\n      className: 'font-medium text-gray-900',\r\n    },\r\n    {\r\n      title: 'STUDENT NAME',\r\n      dataIndex: 'studentName',\r\n      key: 'studentName',\r\n      className: 'text-gray-700',\r\n    },\r\n    {\r\n      title: 'COURSE TITLE',\r\n      dataIndex: 'courseTitle',\r\n      key: 'courseTitle',\r\n      className: 'text-gray-700',\r\n    },\r\n    {\r\n      title: 'ISSUE DATE',\r\n      dataIndex: 'issueDate',\r\n      key: 'issueDate',\r\n      render: (date: string) => dayjs(date).format('DD/MM/YYYY'),\r\n      className: 'text-gray-700',\r\n    },\r\n    {\r\n      title: 'STATUS',\r\n      dataIndex: 'status',\r\n      key: 'status',\r\n      render: (status: 'Issued' | 'Revoked') => (\r\n        <Tag color={status === 'Issued' ? 'green' : 'red'} className=\"rounded-full px-3 py-1 text-xs font-semibold\">\r\n          {status}\r\n        </Tag>\r\n      ),\r\n      className: 'text-center',\r\n    },\r\n    {\r\n      title: 'ACTIONS',\r\n      key: 'actions',\r\n      render: (_: unknown, record: IssuedCertificate) => (\r\n        <Space size=\"middle\">\r\n          <Button\r\n            icon={<EyeOutlined />}\r\n            onClick={() => handleViewIssued(record)}\r\n            className=\"text-gray-500 border-none shadow-none hover:bg-gray-50\"\r\n          />\r\n          <Button\r\n            icon={<DeleteOutlined />}\r\n            danger\r\n            onClick={() => handleDeleteIssued(record.id)}\r\n            className=\"text-red-500 border-none shadow-none hover:bg-red-50\"\r\n          />\r\n        </Space>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  const items: TabsProps['items'] = [\r\n    {\r\n      key: 'templates',\r\n      label: 'จัดการแม่แบบเกียรติบัตร',\r\n      children: (\r\n        <Card className=\"rounded-xl shadow-custom-light p-4\">\r\n          <div className=\"flex justify-between items-center mb-6 gap-10\">\r\n            <Input\r\n              placeholder=\"ค้นหาแม่แบบ\"\r\n              prefix={<SearchOutlined className=\"text-gray-400\" />}\r\n              className=\"w-80 rounded-lg shadow-sm table-search-input\"\r\n              value={searchTermTemplates}\r\n              onChange={(e) => setSearchTermTemplates(e.target.value)}\r\n            />\r\n            <Button\r\n              type=\"primary\"\r\n              onClick={handleCreateTemplate}\r\n              icon={<PlusOutlined />}\r\n              className=\"bg-orange-500 hover:bg-orange-600 text-white rounded-lg shadow-md px-6 py-3 text-base\"\r\n            >\r\n              สร้างแม่แบบใหม่\r\n            </Button>\r\n          </div>\r\n          {hasLoadedTemplates ? (\r\n            <Table\r\n              columns={templateColumns}\r\n              dataSource={filteredTemplates}\r\n              rowKey=\"id\"\r\n              className=\"rounded-xl shadow-custom-light\"\r\n              pagination={{ pageSize: 10 }}\r\n              bordered={false}\r\n            />\r\n          ) : (\r\n            <div className=\"flex justify-center items-center h-40\">\r\n              <Text>กำลังโหลดแม่แบบเกียรติบัตร...</Text>\r\n            </div>\r\n          )}\r\n\r\n          {/* Modal for Viewing Template Details */}\r\n          <Modal\r\n            title=\"รายละเอียดแม่แบบเกียรติบัตร\"\r\n            open={isTemplateDetailModalVisible}\r\n            onCancel={handleTemplateDetailModalCancel}\r\n            footer={\r\n              viewingTemplate?.status === 'Published' ? (\r\n                <Button\r\n                  type=\"primary\"\r\n                  icon={<PrinterOutlined />}\r\n                  onClick={handlePrintCertificate}\r\n                  className=\"bg-blue-500 hover:bg-blue-600 text-white rounded-lg shadow-md px-6 py-3 text-base\"\r\n                >\r\n                  พิมพ์เกียรติบัตร\r\n                </Button>\r\n              ) : null\r\n            }\r\n            className=\"rounded-xl\"\r\n            centered\r\n            width={800} // Adjust width to accommodate the preview\r\n          >\r\n            {viewingTemplate ? (\r\n              <div className=\"p-4 flex flex-col space-y-6\">\r\n                {/* Text Details Section */}\r\n                <div>\r\n                  <p className=\"mb-2\"><Text strong>Template Name:</Text> {viewingTemplate.templateName}</p>\r\n                  <p className=\"mb-2\"><Text strong>Description:</Text> {viewingTemplate.description}</p>\r\n                  <p className=\"mb-2\"><Text strong>Status:</Text> <Tag color={viewingTemplate.status === 'Published' ? 'green' : 'blue'}>{viewingTemplate.status}</Tag></p>\r\n                  <p className=\"mb-2\"><Text strong>Created At:</Text> {dayjs(viewingTemplate.createdAt).format('DD/MM/YYYY, HH:mm')}</p>\r\n                  <p className=\"mb-2\"><Text strong>Updated At:</Text> {dayjs(viewingTemplate.updatedAt).format('DD/MM/YYYY, HH:mm')}</p>\r\n                </div>\r\n\r\n                {/* Certificate Preview Section */}\r\n                <div className=\"mt-4 border p-4 rounded-lg bg-gray-50 flex flex-col items-center\">\r\n                  <Text strong className=\"text-lg block mb-4 text-center\">ตัวอย่างเกียรติบัตร</Text>\r\n                  {viewingTemplate.designElements ? (\r\n                    <div className=\"w-full flex justify-center\">\r\n                      <DynamicCertificateCanvas\r\n                        certificateData={viewingTemplate.designElements}\r\n                        onPositionChange={() => {}} // No-op function as dragging is not needed here\r\n                        stageRef={stageRefForPreview} // Pass ref to get image for printing\r\n                        scale={0.7} // Scale down for preview in modal\r\n                      />\r\n                    </div>\r\n                  ) : (\r\n                    <p className=\"text-center text-red-500\">ไม่สามารถแสดงตัวอย่างได้: ข้อมูลการออกแบบไม่สมบูรณ์</p>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <p>ไม่พบข้อมูล</p>\r\n            )}\r\n          </Modal>\r\n        </Card>\r\n      ),\r\n    },\r\n    {\r\n      key: 'issued',\r\n      label: 'เกียรติบัตรที่ออกแล้ว',\r\n      children: (\r\n        <Card className=\"rounded-xl shadow-custom-light p-4\">\r\n          <div className=\"flex justify-between items-center mb-6\">\r\n            <Input\r\n              placeholder=\"ค้นหาเกียรติบัตรที่ออกแล้ว\"\r\n              prefix={<SearchOutlined className=\"text-gray-400\" />}\r\n              className=\"w-80 rounded-lg shadow-sm table-search-input\"\r\n              value={searchTermIssued}\r\n              onChange={(e) => setSearchTermIssued(e.target.value)}\r\n            />\r\n          </div>\r\n          {hasLoadedIssued ? (\r\n            <Table\r\n              columns={issuedColumns}\r\n              dataSource={filteredIssued}\r\n              rowKey=\"id\"\r\n              className=\"rounded-xl shadow-custom-light\"\r\n              pagination={{ pageSize: 10 }}\r\n              bordered={false}\r\n            />\r\n          ) : (\r\n            <div className=\"flex justify-center items-center h-40\">\r\n              <Text>กำลังโหลดเกียรติบัตรที่ออกแล้ว...</Text>\r\n            </div>\r\n          )}\r\n          {/* Modal for Viewing Issued Certificate Details */}\r\n          <Modal\r\n            title=\"รายละเอียดเกียรติบัตรที่ออกแล้ว\"\r\n            open={isIssuedDetailModalVisible}\r\n            onCancel={handleIssuedDetailModalCancel}\r\n            footer={null}\r\n            className=\"rounded-xl\"\r\n            centered\r\n          >\r\n            {viewingIssued ? (\r\n              <div className=\"p-4\">\r\n                <p className=\"mb-2\"><Text strong>Template Name:</Text> {viewingIssued.templateName}</p>\r\n                {/* Removed description as it's not part of IssuedCertificate */}\r\n                <p className=\"mb-2\"><Text strong>Student Name:</Text> {viewingIssued.studentName}</p>\r\n                <p className=\"mb-2\"><Text strong>Course Title:</Text> {viewingIssued.courseTitle}</p>\r\n                <p className=\"mb-2\"><Text strong>Issue Date:</Text> {dayjs(viewingIssued.issueDate).format('DD/MM/YYYY')}</p>\r\n                <p className=\"mb-2\"><Text strong>Status:</Text> <Tag color={viewingIssued.status === 'Issued' ? 'green' : 'red'}>{viewingIssued.status}</Tag></p>\r\n              </div>\r\n            ) : (\r\n              <p>ไม่พบข้อมูล</p>\r\n            )}\r\n          </Modal>\r\n        </Card>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  const breadcrumbItems = [\r\n    {\r\n      title: <a href=\"/admin/dashboard\"><HomeOutlined /> หน้าหลัก</a>,\r\n    },\r\n    {\r\n      title: <><TrophyOutlined /> เกียรติบัตร</>,\r\n    },\r\n    {\r\n      title: activeTab === 'templates' ? 'จัดการแม่แบบเกียรติบัตร' : 'เกียรติบัตรที่ออกแล้ว',\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n      {/* Breadcrumbs */}\r\n      <Breadcrumb className=\"mb-6\" items={breadcrumbItems} />\r\n\r\n      <AntdTitle level={1} className=\"text-3xl font-bold mb-8 text-gray-800\">การจัดการเกียรติบัตร</AntdTitle>\r\n\r\n      <Tabs\r\n        defaultActiveKey=\"templates\"\r\n        items={items}\r\n        onChange={setActiveTab}\r\n        activeKey={activeTab}\r\n        className=\"rounded-xl shadow-custom-light bg-white\"\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}